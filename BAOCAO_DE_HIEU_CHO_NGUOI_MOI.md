# BÃO CÃO Dá»° ÃN SKETCHLAB
# CHUYá»‚N áº¢NH THÆ¯á»œNG THÃ€NH áº¢NH Váº¼ BÃšT CHÃŒ
## PhiÃªn báº£n dá»… hiá»ƒu cho ngÆ°á»i má»›i báº¯t Ä‘áº§u

---

**Há»c pháº§n**: Xá»­ lÃ½ áº£nh (INT13146)
**TrÆ°á»ng**: Há»c viá»‡n CÃ´ng nghá»‡ BÆ°u chÃ­nh Viá»…n thÃ´ng
**NÄƒm**: 2025

---

## ğŸ“š Má»¤C Lá»¤C

1. [Giá»›i thiá»‡u - Dá»± Ã¡n nÃ y lÃ m gÃ¬?](#1-giá»›i-thiá»‡u)
2. [VÃ­ dá»¥ minh há»a - Xem káº¿t quáº£ trÆ°á»›c](#2-vÃ­-dá»¥-minh-há»a)
3. [Hai cÃ¡ch chuyá»ƒn Ä‘á»•i áº£nh](#3-hai-cÃ¡ch-chuyá»ƒn-Ä‘á»•i-áº£nh)
4. [Giáº£i thÃ­ch tá»«ng bÆ°á»›c chi tiáº¿t](#4-giáº£i-thÃ­ch-tá»«ng-bÆ°á»›c-chi-tiáº¿t)
5. [CÃ¡ch sá»­ dá»¥ng á»©ng dá»¥ng](#5-cÃ¡ch-sá»­-dá»¥ng-á»©ng-dá»¥ng)
6. [CÃ¢u há»i thÆ°á»ng gáº·p](#6-cÃ¢u-há»i-thÆ°á»ng-gáº·p)
7. [Tá»•ng káº¿t](#7-tá»•ng-káº¿t)

---

## 1. GIá»šI THIá»†U

### Dá»± Ã¡n nÃ y lÃ m gÃ¬?

Báº¡n cÃ³ bao giá» muá»‘n biáº¿n má»™t bá»©c áº£nh chá»¥p thÆ°á»ng thÃ nh má»™t bá»©c tranh váº½ bÃºt chÃ¬ khÃ´ng? ÄÃ³ chÃ­nh xÃ¡c lÃ  Ä‘iá»u dá»± Ã¡n **SketchLab** lÃ m!

**VÃ­ dá»¥ Ä‘Æ¡n giáº£n:**
```
áº¢nh gá»‘c (báº¡n chá»¥p báº±ng Ä‘iá»‡n thoáº¡i):
- CÃ³ mÃ u sáº¯c Ä‘áº§y Ä‘á»§
- NhÃ¬n ráº¥t tháº­t
- Giá»‘ng nhÆ° báº¡n nhÃ¬n báº±ng máº¯t

â†“ Sau khi xá»­ lÃ½ â†“

áº¢nh sketch (tranh váº½):
- Chá»‰ cÃ²n mÃ u Ä‘en tráº¯ng
- CÃ³ nÃ©t váº½ nhÆ° váº½ báº±ng bÃºt chÃ¬
- TrÃ´ng nhÆ° nghá»‡ sÄ© váº½ ra
```

### Táº¡i sao lÃ m dá»± Ã¡n nÃ y?

1. **Há»c táº­p**: Ãp dá»¥ng kiáº¿n thá»©c mÃ´n Xá»­ lÃ½ áº£nh
2. **Thá»±c tiá»…n**: Táº¡o hiá»‡u á»©ng nghá»‡ thuáº­t tá»« áº£nh thÆ°á»ng
3. **SÃ¡ng táº¡o**: LÃ m app cÃ³ thá»ƒ dÃ¹ng tháº­t, khÃ´ng chá»‰ lÃ½ thuyáº¿t

### CÃ´ng nghá»‡ sá»­ dá»¥ng (giáº£i thÃ­ch Ä‘Æ¡n giáº£n)

- **Python**: NgÃ´n ngá»¯ láº­p trÃ¬nh (nhÆ° tiáº¿ng Anh Ä‘á»ƒ nÃ³i chuyá»‡n vá»›i mÃ¡y tÃ­nh)
- **OpenCV**: ThÆ° viá»‡n xá»­ lÃ½ áº£nh (nhÆ° há»™p cÃ´ng cá»¥ cÃ³ sáºµn nhiá»u chá»©c nÄƒng)
- **Flask**: Táº¡o website (Ä‘á»ƒ cÃ³ giao diá»‡n Ä‘áº¹p, khÃ´ng pháº£i dÃ²ng lá»‡nh)

---

## 2. VÃ Dá»¤ MINH Há»ŒA

### HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n váº½ má»™t bá»©c tranh báº±ng bÃºt chÃ¬

**Khi váº½ báº±ng tay, nghá»‡ sÄ© lÃ m gÃ¬?**

1. **Váº½ viá»n**: Váº½ Ä‘Æ°á»ng nÃ©t bao quanh váº­t thá»ƒ
   ```
   VÃ­ dá»¥: Váº½ khuÃ´n máº·t
   - Váº½ Ä‘Æ°á»ng viá»n khuÃ´n máº·t
   - Váº½ Ä‘Æ°á»ng viá»n máº¯t, mÅ©i, miá»‡ng
   ```

2. **TÃ´ bÃ³ng (shading)**: TÃ´ Ä‘áº­m/nháº¡t Ä‘á»ƒ táº¡o hiá»‡u á»©ng 3D
   ```
   VÃ­ dá»¥: GÃ² mÃ¡
   - Chá»— lá»“i ra: váº½ nháº¡t (Ã­t bÃºt chÃ¬)
   - Chá»— lÃµm vÃ o: váº½ Ä‘áº­m (nhiá»u bÃºt chÃ¬)
   ```

**MÃ¡y tÃ­nh lÃ m tÆ°Æ¡ng tá»±:**

Dá»± Ã¡n nÃ y cÃ³ **2 cÃ¡ch** Ä‘á»ƒ mÃ¡y tÃ­nh "váº½":

1. **CÃ¡ch 1 (Dodge-Burn)**: Chá»‰ táº­p trung vÃ o **tÃ´ bÃ³ng**
   - NhÆ° nghá»‡ sÄ© váº½ nháº¹ nhÃ ng, tÃ´ Ä‘áº­m nháº¡t
   - Káº¿t quáº£: Má»m máº¡i, nghá»‡ thuáº­t

2. **CÃ¡ch 2 (Combined)**: Vá»«a **váº½ viá»n** vá»«a **tÃ´ bÃ³ng**
   - NhÆ° nghá»‡ sÄ© vá»«a váº½ Ä‘Æ°á»ng nÃ©t rÃµ rÃ ng, vá»«a tÃ´ bÃ³ng
   - Káº¿t quáº£: RÃµ rÃ ng hÆ¡n, Ä‘áº¹p hÆ¡n

---

## 3. HAI CÃCH CHUYá»‚N Äá»”I áº¢NH

### ğŸ¨ CÃCH 1: DODGE-BURN SKETCH

#### Giáº£i thÃ­ch báº±ng ngÃ´n ngá»¯ Ä‘á»i thÆ°á»ng

**Dodge** vÃ  **Burn** lÃ  2 ká»¹ thuáº­t tá»« nhiáº¿p áº£nh truyá»n thá»‘ng:

- **Dodge** = LÃ m sÃ¡ng (nhÆ° dÃ¹ng táº©y lÃ m nháº¡t bá»›t)
- **Burn** = LÃ m tá»‘i (nhÆ° tÃ´ thÃªm bÃºt chÃ¬)

**TÆ°Æ¡ng tá»± trong Ä‘á»i sá»‘ng:**

TÆ°á»Ÿng tÆ°á»£ng báº¡n cÃ³ má»™t bá»©c áº£nh in trÃªn giáº¥y, vÃ  má»™t cÃ¢y Ä‘Ã¨n chiáº¿u tá»« trÃªn xuá»‘ng:

1. Chá»— nÃ o báº¡n **che tay** â†’ Ã­t Ã¡nh sÃ¡ng â†’ áº£nh sÃ¡ng hÆ¡n (Dodge)
2. Chá»— nÃ o báº¡n **Ä‘á»ƒ lÃ¢u hÆ¡n** â†’ nhiá»u Ã¡nh sÃ¡ng â†’ áº£nh tá»‘i hÆ¡n (Burn)

#### CÃ¡c bÆ°á»›c Ä‘Æ¡n giáº£n (khÃ´ng cáº§n hiá»ƒu code)

**ğŸ“ Location trong code:** `sketch_converter.py` dÃ²ng 24-98

**BÆ°á»›c 0: Biáº¿n áº£nh mÃ u thÃ nh Ä‘en tráº¯ng (náº¿u cáº§n)**
```
áº¢nh gá»‘c: ğŸŒˆ (nhiá»u mÃ u)
        â†“
áº¢nh Ä‘en tráº¯ng: â¬œâ¬› (chá»‰ cÃ³ tráº¯ng Ä‘en)

Code: cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
```
*Táº¡i sao?* Tranh váº½ bÃºt chÃ¬ khÃ´ng cÃ³ mÃ u!

**BÆ°á»›c 1: Cáº£i thiá»‡n Ä‘á»™ sÃ¡ng tá»‘i (CLAHE)**
```
VÃ­ dá»¥:
- áº¢nh ban Ä‘áº§u: Máº·t quÃ¡ tá»‘i, ná»n quÃ¡ sÃ¡ng
- Sau khi cáº£i thiá»‡n: Máº·t sÃ¡ng vá»«a, ná»n tá»‘i vá»«a

Ká»¹ thuáº­t: CLAHE (Contrast Limited Adaptive Histogram Equalization)
```
*Táº¡i sao?* Äá»ƒ nhÃ¬n rÃµ chi tiáº¿t hÆ¡n, Ä‘áº·c biá»‡t vÃ¹ng tá»‘i vÃ  vÃ¹ng sÃ¡ng

**BÆ°á»›c 2: "Äáº£o ngÆ°á»£c" áº£nh láº§n 1 (nhÆ° Ã¢m báº£n phim)**
```
TrÆ°á»›c: Trá»i sÃ¡ng â¬œ, cÃ¢y tá»‘i â¬›
Sau:  Trá»i tá»‘i â¬›, cÃ¢y sÃ¡ng â¬œ

Code: cv2.bitwise_not(enhanced)
```
*Táº¡i sao?* Cáº§n thiáº¿t cho cÃ´ng thá»©c dodge-burn

**BÆ°á»›c 3: LÃ m má» áº£nh Ä‘Ã£ Ä‘áº£o (Gaussian Blur)**
```
áº¢nh Ä‘áº£o (sáº¯c nÃ©t):  â–“â–“â–“â–“
                    â†“
áº¢nh má»:            â–‘â–‘â–‘â–‘

Code: GaussianBlur vá»›i kernel 21Ã—21
```
*Táº¡i sao?* Táº¡o hiá»‡u á»©ng má»m máº¡i, giá»‘ng váº½ tay

**BÆ°á»›c 4: Äáº£o ngÆ°á»£c láº§n 2**
```
áº¢nh má» (Ä‘Ã£ Ä‘áº£o):  â¬›â¬›â¬›
                  â†“
Äáº£o láº¡i:         â¬œâ¬œâ¬œ

Code: cv2.bitwise_not(blurred)
```
*Táº¡i sao?* Chuáº©n bá»‹ cho phÃ©p chia

**BÆ°á»›c 5: Äáº£m báº£o khÃ´ng chia cho sá»‘ quÃ¡ nhá»**
```
Náº¿u pixel < 10 â†’ Äáº·t = 10

Code: np.where(pixel < 10, 10, pixel)
```
*Táº¡i sao?* TrÃ¡nh táº¡o Ä‘á»‘m tráº¯ng lá»—i (white spots)

**BÆ°á»›c 6: "Chia" áº£nh gá»‘c cho áº£nh Ä‘Ã£ xá»­ lÃ½ (MA THUáº¬T!)**
```
CÃ´ng thá»©c:
Sketch = (áº¢nh gá»‘c Ã— 256) / áº¢nh Ä‘Ã£ xá»­ lÃ½

Code: cv2.divide(enhanced, inverted_blurred, scale=256.0)

Giáº£i thÃ­ch:
- Chá»— nÃ o áº£nh gá»‘c SÃNG, áº£nh xá»­ lÃ½ Tá»I â†’ Sketch Ráº¤T SÃNG âœ¨
- Chá»— nÃ o áº£nh gá»‘c Tá»I, áº£nh xá»­ lÃ½ SÃNG â†’ Sketch Tá»I ğŸ–¤
```
*Táº¡i sao?* ÄÃ¢y lÃ  cÃ´ng thá»©c chÃ­nh táº¡o hiá»‡u á»©ng sketch!

**BÆ°á»›c 7: Giá»›i háº¡n giÃ¡ trá»‹ vá» [0, 255]**
```
Náº¿u > 255 â†’ Äáº·t = 255
Náº¿u < 0   â†’ Äáº·t = 0

Code: np.clip(sketch, 0, 255)
```
*Táº¡i sao?* Äáº£m báº£o giÃ¡ trá»‹ pixel há»£p lá»‡

**BÆ°á»›c 8: LÃ m má» nháº¹ cuá»‘i cÃ¹ng (Post-processing)**
```
Blur ráº¥t nháº¹ vá»›i kernel 3Ã—3

Code: GaussianBlur(sketch, (3, 3), 0.3)
```
*Táº¡i sao?* Giáº£m pixel noise nhÆ°ng váº«n giá»¯ sáº¯c nÃ©t

**Káº¿t quáº£:**
```
TrÆ°á»›c:  ğŸ“¸ (áº£nh chá»¥p thÆ°á»ng)
Sau:    âœï¸ (tranh váº½ bÃºt chÃ¬)
```

#### VÃ­ dá»¥ cá»¥ thá»ƒ: Theo dÃµi 1 pixel qua 9 bÆ°á»›c

Giáº£ sá»­ cÃ³ 1 pixel (Ä‘iá»ƒm áº£nh):

```
GiÃ¡ trá»‹ pixel trong áº£nh: tá»« 0 (Ä‘en) Ä‘áº¿n 255 (tráº¯ng)

BÆ°á»›c 0: Pixel gá»‘c mÃ u RGB(100,100,100)
        â†’ Grayscale = 100 (xÃ¡m nháº¡t)

BÆ°á»›c 1: CLAHE cáº£i thiá»‡n
        â†’ 100 â†’ 120 (sÃ¡ng hÆ¡n chÃºt)

BÆ°á»›c 2: Äáº£o ngÆ°á»£c láº§n 1
        â†’ 120 â†’ 255-120 = 135

BÆ°á»›c 3: LÃ m má» (trung bÃ¬nh vá»›i hÃ ng xÃ³m)
        â†’ 135 â†’ 130

BÆ°á»›c 4: Äáº£o ngÆ°á»£c láº§n 2
        â†’ 130 â†’ 255-130 = 125

BÆ°á»›c 5: Kiá»ƒm tra minimum
        â†’ 125 > 10 âœ“ (OK, giá»¯ nguyÃªn 125)

BÆ°á»›c 6: Chia (MA THUáº¬T!)
        â†’ (120 Ã— 256) / 125 = 245.76 â‰ˆ 246

BÆ°á»›c 7: Clip
        â†’ 246 náº±m trong [0, 255] âœ“ (giá»¯ nguyÃªn)

BÆ°á»›c 8: Post-blur nháº¹
        â†’ 246 â†’ 245 (giáº£m 1 Ä‘Æ¡n vá»‹)

â†’ Káº¾T QUáº¢ CUá»I: Pixel = 245 (ráº¥t sÃ¡ng!)
â†’ Pixel nÃ y sáº½ lÃ  Ä‘iá»ƒm SÃNG trong tranh váº½
```

---

### ğŸ¨ CÃCH 2: COMBINED SKETCH

#### Giáº£i thÃ­ch báº±ng ngÃ´n ngá»¯ Ä‘á»i thÆ°á»ng

CÃ¡ch nÃ y **káº¿t há»£p 2 ká»¹ thuáº­t**:

1. **70% TÃ´ bÃ³ng** (tá»« CÃ¡ch 1)
2. **30% Váº½ viá»n** (ká»¹ thuáº­t má»›i)

**TÆ°Æ¡ng tá»± trong Ä‘á»i sá»‘ng:**

TÆ°á»Ÿng tÆ°á»£ng 2 há»a sÄ© cÃ¹ng váº½ 1 bá»©c tranh:

- **Há»a sÄ© A**: ChuyÃªn tÃ´ bÃ³ng, lÃ m má»m máº¡i â†’ Cá»‘ng hiáº¿n 70%
- **Há»a sÄ© B**: ChuyÃªn váº½ Ä‘Æ°á»ng nÃ©t, lÃ m rÃµ rÃ ng â†’ Cá»‘ng hiáº¿n 30%

Káº¿t quáº£: Tranh vá»«a má»m máº¡i, vá»«a rÃµ rÃ ng!

#### Pháº§n má»›i: "Váº½ viá»n" lÃ  gÃ¬?

**PhÃ¡t hiá»‡n biÃªn (Edge Detection)** = TÃ¬m chá»— cÃ³ Ä‘Æ°á»ng viá»n trong áº£nh

**VÃ­ dá»¥ thá»±c táº¿:**

```
Bá»©c áº£nh chá»¥p quáº£ tÃ¡o:
ğŸ
- BiÃªn = ÄÆ°á»ng viá»n quanh quáº£ tÃ¡o
- KhÃ´ng pháº£i biÃªn = Pháº§n trong quáº£ tÃ¡o (mÃ u Ä‘á»“ng Ä‘á»u)
```

**MÃ¡y tÃ­nh lÃ m tháº¿ nÃ o?**

TÃ¬m nhá»¯ng chá»— **thay Ä‘á»•i Ä‘á»™t ngá»™t** vá» Ä‘á»™ sÃ¡ng:

```
VÃ­ dá»¥: Má»™t dÃ²ng pixel
[10, 10, 10, 200, 200, 200]
              â†‘
         BiÃªn á»Ÿ Ä‘Ã¢y! (nháº£y tá»« 10 lÃªn 200)
```

**Thuáº­t toÃ¡n Canny** (tÃªn ngÆ°á»i phÃ¡t minh: John Canny)

ÄÃ¢y lÃ  cÃ¡ch **THÃ”NG MINH NHáº¤T** Ä‘á»ƒ tÃ¬m viá»n, gá»“m 5 bÆ°á»›c:

**BÆ°á»›c 1: LÃ m má» nháº¹ Ä‘á»ƒ bá» nhiá»…u**
```
áº¢nh gá»‘c (cÃ³ nhiá»…u):  â–“â–“â–’â–“â–“
                      â†“
áº¢nh má» (bá»›t nhiá»…u):  â–“â–“â–“â–“â–“
```
*Táº¡i sao?* Nhiá»…u (nhÆ° Ä‘iá»ƒm lá»‘m Ä‘á»‘m) sáº½ bá»‹ nháº§m lÃ  viá»n

**BÆ°á»›c 2: TÃ­nh "Ä‘á»™ dá»‘c" (Gradient)**

```
TÆ°á»Ÿng tÆ°á»£ng áº£nh lÃ  báº£n Ä‘á»“ Ä‘á»‹a hÃ¬nh:
- Chá»— pháº³ng = khÃ´ng Ä‘á»•i mÃ u = KHÃ”NG pháº£i viá»n
- Chá»— dá»‘c = Ä‘á»•i mÃ u nhanh = CÃ“ THá»‚ lÃ  viá»n

CÃ´ng thá»©c Ä‘Æ¡n giáº£n:
Äá»™ dá»‘c = |Pixel bÃªn pháº£i - Pixel bÃªn trÃ¡i|
```

VÃ­ dá»¥:
```
[100, 100, 100, 200, 200, 200]
  â†“     â†“     â†“     â†“     â†“
[0,    0,    50,   0,    0]    â† Äá»™ dá»‘c
              â†‘
         Dá»‘c cao nháº¥t!
```

**BÆ°á»›c 3: Giá»¯ láº¡i chá»— dá»‘c nháº¥t**
```
Trong 1 vÃ¹ng, chá»‰ giá»¯ pixel cÃ³ Ä‘á»™ dá»‘c CAO NHáº¤T
â†’ Viá»n chá»‰ dÃ y 1 pixel, ráº¥t má»ng
```

**BÆ°á»›c 4: PhÃ¢n loáº¡i viá»n**
```
Äá»™ dá»‘c > 100: CHáº®C CHáº®N lÃ  viá»n (giá»¯ láº¡i)
50 < Äá»™ dá»‘c < 100: NGHI NGá»œ lÃ  viá»n (xem tiáº¿p)
Äá»™ dá»‘c < 50: KHÃ”NG pháº£i viá»n (bá» Ä‘i)
```

**BÆ°á»›c 5: Ná»‘i cÃ¡c viá»n**
```
Náº¿u viá»n "nghi ngá»" náº±m cáº¡nh viá»n "cháº¯c cháº¯n":
â†’ Giá»¯ láº¡i (vÃ¬ cÃ³ thá»ƒ lÃ  pháº§n ná»‘i tiáº¿p)

Náº¿u viá»n "nghi ngá»" Ä‘á»©ng 1 mÃ¬nh:
â†’ Bá» Ä‘i (cÃ³ thá»ƒ chá»‰ lÃ  nhiá»…u)
```

**Káº¿t quáº£:**
```
áº¢nh gá»‘c: ğŸ“¸
        â†“
Chá»‰ cÃ²n viá»n: ğŸ–¼ï¸ (nhÆ° áº£nh phÃ¡c tháº£o)
```

#### CÃ¡c bÆ°á»›c thá»±c hiá»‡n theo code

**ğŸ“ Location trong code:** `sketch_converter.py:100-144` + `edge_detector.py:50-89`

Combined method hoáº¡t Ä‘á»™ng nhÆ° 2 há»a sÄ© váº½ CÃ™NG LÃšC, sau Ä‘Ã³ trá»™n káº¿t quáº£:

---

**BÆ¯á»šC 0: Biáº¿n áº£nh thÃ nh Ä‘en tráº¯ng (chung cho 2 nhÃ¡nh)**
```
áº¢nh mÃ u â†’ áº¢nh Ä‘en tráº¯ng
```

---

**NHÃNH A - Há»a sÄ© A: Dodge-Burn** (9 bÆ°á»›c nhÆ° CÃ¡ch 1)

```
Há»a sÄ© A lÃ m:
1. Cáº£i thiá»‡n Ä‘á»™ sÃ¡ng (CLAHE)
2-8. CÃ¡c bÆ°á»›c Dodge-Burn (nhÆ° Ä‘Ã£ há»c á»Ÿ CÃ¡ch 1)

Káº¿t quáº£: áº¢nh vá»›i tÃ´ bÃ³ng má»m máº¡i ğŸ¨
```

---

**NHÃNH B - Há»a sÄ© B: Váº½ viá»n (Canny Edge Detection)**

Há»a sÄ© B lÃ m 6 bÆ°á»›c Ä‘á»ƒ tÃ¬m viá»n:

**B.1: Cáº£i thiá»‡n Ä‘á»™ sÃ¡ng (CLAHE riÃªng)**
```
CÅ©ng dÃ¹ng CLAHE, nhÆ°ng cho edge detection
Code: cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))
```

**B.2: Lá»c nhiá»…u nhÆ°ng giá»¯ viá»n (Bilateral Filter)**
```
LÃ m mÆ°á»£t áº£nh NHÆ¯NG khÃ´ng lÃ m má» viá»n
Code: cv2.bilateralFilter(enhanced, 9, 75, 75)

KhÃ¡c vá»›i lÃ m má» thÆ°á»ng:
- LÃ m má» thÆ°á»ng: Má»i thá»© Ä‘á»u má»
- Bilateral: Chá»‰ má» chá»— pháº³ng, GIá»® viá»n
```

**B.3: TÃ­nh ngÆ°á»¡ng tá»± Ä‘á»™ng (Adaptive Threshold)**
```
MÃ¡y tÃ­nh Tá»° Äá»˜NG tÃ­nh threshold dá»±a trÃªn áº£nh:

median = GiÃ¡ trá»‹ giá»¯a cá»§a áº£nh
low = 67% cá»§a median
high = 133% cá»§a median

VÃ­ dá»¥: Náº¿u median = 100
â†’ low = 67, high = 133
```

**B.4: TÃ¬m viá»n (Canny)**
```
cv2.Canny(image, low=67, high=133)

BÃªn trong Canny tá»± Ä‘á»™ng lÃ m 4 viá»‡c:
1. LÃ m má» Gaussian
2. TÃ­nh Ä‘á»™ dá»‘c (gradient)
3. Giá»¯ Ä‘iá»ƒm dá»‘c nháº¥t
4. Ná»‘i viá»n

Káº¿t quáº£: áº¢nh chá»‰ cÃ²n viá»n (Ä‘en tráº¯ng)
```

**B.5: LÃ m mÆ°á»£t viá»n nháº¹ (Anti-aliasing)**
```
Blur ráº¥t nháº¹ Ä‘á»ƒ viá»n mÆ°á»£t hÆ¡n
Code: GaussianBlur(edges, (3,3), 0.3)
```

**Káº¿t quáº£ nhÃ¡nh B:** áº¢nh chá»‰ cÃ³ viá»n ğŸ–¼ï¸

---

**TRá»˜N VÃ€ LÃ€M Äáº¸P** (5 bÆ°á»›c)

**BÆ°á»›c 1: Trá»™n 2 nhÃ¡nh (Alpha Blending)**
```
Káº¿t quáº£ = 70% Há»a sÄ© A + 30% Há»a sÄ© B
        = 0.7 Ã— Dodge-Burn + 0.3 Ã— Edges

Code: cv2.addWeighted(sketch_db, 0.7, edges, 0.3, 0)
```

**BÆ°á»›c 2: Lá»c mÆ°á»£t giá»¯ viá»n (Bilateral láº§n 2)**
```
Giáº£m Ä‘á»‘m tráº¯ng tá»« dodge-burn
NhÆ°ng váº«n GIá»® viá»n rÃµ rÃ ng

Code: cv2.bilateralFilter(sketch, 5, 50, 50)
```

**BÆ°á»›c 3: TÄƒng Ä‘á»™ sáº¯c nÃ©t (Unsharp Masking)**
```
Táº¡o báº£n má» â†’ So sÃ¡nh vá»›i gá»‘c â†’ ThÃªm chi tiáº¿t

Blur = GaussianBlur(sketch)
Sharp = sketchÃ—2.0 - BlurÃ—1.0

â†’ áº¢nh sáº¯c nÃ©t hÆ¡n!
```

**BÆ°á»›c 4: LÃ m ná»•i viá»n (Morphological Gradient)**
```
Phá»“ng áº£nh â†’ Co áº£nh â†’ Láº¥y pháº§n chÃªnh lá»‡ch = Viá»n!
Trá»™n 10% viá»n vÃ o áº£nh

Code:
gradient = Dilation - Erosion
Result = 90% sketch + 10% gradient
```

**BÆ°á»›c 5: Giá»›i háº¡n giÃ¡ trá»‹ cuá»‘i cÃ¹ng**
```
Äáº£m báº£o pixel trong [0, 255]
Code: np.clip(sketch, 0, 255)
```

**Káº¾T QUáº¢ CUá»I:**
```
áº¢nh cÃ³ cáº£:
- TÃ´ bÃ³ng má»m máº¡i (tá»« Dodge-Burn)
- Viá»n rÃµ rÃ ng (tá»« Canny)
- Äá»™ sáº¯c nÃ©t cao (tá»« Unsharp)
- Viá»n Ä‘Æ°á»£c tÄƒng cÆ°á»ng (tá»« Morphological)

â†’ Tranh sketch Ä‘áº¹p nháº¥t! âœï¸
```

#### Káº¿t há»£p láº¡i

**BÆ°á»›c cuá»‘i: Trá»™n 2 áº£nh**

```python
áº¢nh Dodge-Burn:  ğŸ¨ (tÃ´ bÃ³ng má»m)
áº¢nh Edges:       ğŸ–¼ï¸ (viá»n rÃµ)
                  â†“
Káº¿t quáº£ = 70% ğŸ¨ + 30% ğŸ–¼ï¸ = âœï¸ (tranh hoÃ n chá»‰nh)
```

**VÃ­ dá»¥ cá»¥ thá»ƒ:**

```
Táº¡i 1 pixel:

Dodge-Burn cho giÃ¡ trá»‹: 200 (khÃ¡ sÃ¡ng)
Edges cho giÃ¡ trá»‹:      100 (trung bÃ¬nh)

Káº¿t há»£p:
= 0.7 Ã— 200 + 0.3 Ã— 100
= 140 + 30
= 170 (sÃ¡ng vá»«a pháº£i)
```

**Táº¡i sao 70-30?**

Qua thá»­ nghiá»‡m, tá»· lá»‡ nÃ y cho káº¿t quáº£ Äáº¸P NHáº¤T:
- Náº¿u 90-10: QuÃ¡ má»m, máº¥t viá»n
- Náº¿u 50-50: QuÃ¡ cá»©ng, máº¥t tá»± nhiÃªn
- **70-30**: Vá»«a Ä‘á»§! ğŸ‘

#### CÃ¡c bÆ°á»›c lÃ m Ä‘áº¹p thÃªm

Sau khi trá»™n xong, cÃ²n 3 bÆ°á»›c "lÃ m Ä‘áº¹p":

**1. Lá»c Bilateral (LÃ m mÆ°á»£t nhÆ°ng giá»¯ viá»n)**

```
KhÃ¡c vá»›i lÃ m má» thÆ°á»ng:
- LÃ m má» thÆ°á»ng: Má»i thá»© Ä‘á»u má» (ká»ƒ cáº£ viá»n)
- Bilateral: Chá»‰ má» chá»— pháº³ng, GIá»® NGUYÃŠN viá»n

VÃ­ dá»¥:
TrÆ°á»›c: â–“â–“â–“â”‚â–“â–“â–“  (viá»n á»Ÿ giá»¯a, 2 bÃªn cÃ³ nhiá»…u nhá»)
       â–‘â–‘â–‘â”‚â–“â–“â–“
Sau:  â–‘â–‘â–‘â”‚â–“â–“â–“  (nhiá»…u máº¥t, viá»n váº«n rÃµ)
```

**2. Unsharp Masking (LÃ m sáº¯c nÃ©t)**

TÃªn cÃ³ "unsharp" (khÃ´ng sáº¯c nÃ©t) nhÆ°ng láº¡i lÃ m Sáº®C NÃ‰T! Láº¡ chÆ°a? ğŸ˜„

CÃ¡ch hoáº¡t Ä‘á»™ng:
```
BÆ°á»›c 1: Táº¡o báº£n má» cá»§a áº£nh
BÆ°á»›c 2: TÃ¬m pháº§n khÃ¡c biá»‡t = áº¢nh gá»‘c - áº¢nh má»
        (pháº§n nÃ y lÃ  chi tiáº¿t nhá»)
BÆ°á»›c 3: Cá»˜NG chi tiáº¿t vÃ o áº£nh gá»‘c
        â†’ áº¢nh gá»‘c + Chi tiáº¿t = áº¢nh sáº¯c nÃ©t hÆ¡n!

VÃ­ dá»¥ sá»‘:
Pixel gá»‘c: 100
Pixel má»:  95
KhÃ¡c biá»‡t: 100 - 95 = 5 (chi tiáº¿t)
Káº¿t quáº£:   100 + 5 = 105 (sáº¯c nÃ©t hÆ¡n!)
```

**3. Morphological Gradient (LÃ m ná»•i viá»n)**

```
CÃ¡ch lÃ m:
1. "Phá»“ng" áº£nh ra 1 chÃºt
2. "Co" áº£nh láº¡i 1 chÃºt
3. TÃ­nh pháº§n chÃªnh lá»‡ch = Viá»n!
4. ThÃªm 10% viá»n vÃ o áº£nh

Káº¿t quáº£: ÄÆ°á»ng nÃ©t rÃµ rÃ ng hÆ¡n
```

---

## 4. GIáº¢I THÃCH Tá»ªNG BÆ¯á»šC CHI TIáº¾T

### ğŸ“– Pháº§n 1: Nhá»¯ng khÃ¡i niá»‡m cÆ¡ báº£n

#### 4.1. áº¢nh lÃ  gÃ¬ trong mÃ¡y tÃ­nh?

**áº¢nh = Ma tráº­n (báº£ng) cÃ¡c con sá»‘**

```
VÃ­ dá»¥ áº£nh 5Ã—5 pixels (ráº¥t nhá»):

[
  [255, 255, 255, 255, 255]   â† DÃ²ng 1: Tráº¯ng hoÃ n toÃ n
  [255, 100, 100, 100, 255]   â† DÃ²ng 2: Viá»n tráº¯ng, giá»¯a xÃ¡m
  [255, 100,   0, 100, 255]   â† DÃ²ng 3: Giá»¯a cÃ³ Ä‘iá»ƒm Ä‘en
  [255, 100, 100, 100, 255]   â† DÃ²ng 4: Giá»‘ng dÃ²ng 2
  [255, 255, 255, 255, 255]   â† DÃ²ng 5: Tráº¯ng hoÃ n toÃ n
]

Quy Æ°á»›c:
- 0   = Äen tuyá»‡t Ä‘á»‘i â¬›
- 128 = XÃ¡m â–’
- 255 = Tráº¯ng tuyá»‡t Ä‘á»‘i â¬œ
```

**áº¢nh mÃ u:**
```
Má»—i pixel cÃ³ 3 giÃ¡ trá»‹ (RGB):
- R (Red):   0-255
- G (Green): 0-255
- B (Blue):  0-255

VÃ­ dá»¥:
[255, 0, 0]   = Äá» ğŸ”´
[0, 255, 0]   = Xanh lÃ¡ ğŸŸ¢
[0, 0, 255]   = Xanh dÆ°Æ¡ng ğŸ”µ
[255, 255, 0] = VÃ ng ğŸŸ¡ (Ä‘á» + xanh lÃ¡)
[0, 0, 0]     = Äen â¬›
[255, 255, 255] = Tráº¯ng â¬œ
```

#### 4.2. CLAHE lÃ  gÃ¬? (Cáº£i thiá»‡n Ä‘á»™ tÆ°Æ¡ng pháº£n)

**TÃªn Ä‘áº§y Ä‘á»§:** Contrast Limited Adaptive Histogram Equalization

Nghe phá»©c táº¡p nhá»‰? HÃ£y chia nhá» ra:

**Histogram lÃ  gÃ¬?**
```
Histogram = Biá»ƒu Ä‘á»“ Ä‘áº¿m pixel

VÃ­ dá»¥ áº£nh cÃ³ 100 pixels:
- 50 pixels cÃ³ giÃ¡ trá»‹ 0-50 (tá»‘i)
- 30 pixels cÃ³ giÃ¡ trá»‹ 51-150 (trung bÃ¬nh)
- 20 pixels cÃ³ giÃ¡ trá»‹ 151-255 (sÃ¡ng)

Váº½ biá»ƒu Ä‘á»“:
Sá»‘ pixel
  â†‘
50|  â–ˆâ–ˆ
40|  â–ˆâ–ˆ
30|  â–ˆâ–ˆ  â–ˆâ–ˆ
20|  â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ
10|  â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ
  +--+---+---+---â†’ Äá»™ sÃ¡ng
    Tá»‘i Trung SÃ¡ng
```

**Equalization (CÃ¢n báº±ng) lÃ  gÃ¬?**

LÃ m cho histogram "pháº³ng" hÆ¡n:

```
TrÆ°á»›c:
  â–ˆâ–ˆ              â† Nhiá»u chá»— tá»‘i
  â–ˆâ–ˆ
  â–ˆâ–ˆ  â–ˆ           â† Ãt chá»— sÃ¡ng
  +--+---+---+

Sau Equalization:
  â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ      â† PhÃ¢n bá»‘ Ä‘á»u hÆ¡n
  â–ˆâ–ˆ  â–ˆâ–ˆ  â–ˆâ–ˆ
  +--+---+---+

Káº¿t quáº£: áº¢nh cÃ³ Ä‘á»™ tÆ°Æ¡ng pháº£n tá»‘t hÆ¡n!
```

**Adaptive (ThÃ­ch nghi) lÃ  gÃ¬?**

Thay vÃ¬ cÃ¢n báº±ng TOÃ€N áº¢NH, chia áº£nh thÃ nh nhiá»u vÃ¹ng nhá»:

```
áº¢nh lá»›n:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VÃ¹ng 1 â”‚  VÃ¹ng 2 â”‚  â† Má»—i vÃ¹ng cÃ¢n báº±ng riÃªng
â”‚  (Tá»‘i)  â”‚  (SÃ¡ng) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  VÃ¹ng 3 â”‚  VÃ¹ng 4 â”‚
â”‚ (Trung) â”‚  (Tá»‘i)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Lá»£i Ã­ch: VÃ¹ng tá»‘i Ä‘Æ°á»£c cáº£i thiá»‡n mÃ  khÃ´ng lÃ m vÃ¹ng sÃ¡ng quÃ¡ sÃ¡ng
```

**Contrast Limited (Giá»›i háº¡n tÆ°Æ¡ng pháº£n) lÃ  gÃ¬?**

NgÄƒn khÃ´ng cho má»™t vÃ¹ng trá»Ÿ nÃªn QUÃ sÃ¡ng hoáº·c QUÃ tá»‘i:

```
Histogram trÆ°á»›c khi giá»›i háº¡n:
     â–ˆâ–ˆâ–ˆâ–ˆ         â† QuÃ¡ cao! Sáº½ gÃ¢y nhiá»…u
     â–ˆâ–ˆâ–ˆâ–ˆ
  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ

Histogram sau khi cáº¯t (clip):
  â”€â”€ â”€â”€â”€â”€ â”€â”€      â† NgÆ°á»¡ng giá»›i háº¡n
  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ      â† Pháº§n vÆ°á»£t bá»‹ cáº¯t
  â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ

â†’ TrÃ¡nh tÄƒng nhiá»…u quÃ¡ má»©c
```

**Káº¿t luáº­n CLAHE:**

CLAHE = CÃ¢n báº±ng histogram tá»«ng vÃ¹ng + Giá»›i háº¡n má»©c tÄƒng

Káº¿t quáº£:
- VÃ¹ng tá»‘i â†’ SÃ¡ng hÆ¡n
- VÃ¹ng sÃ¡ng â†’ Tá»‘i hÆ¡n
- KhÃ´ng táº¡o nhiá»…u quÃ¡ má»©c
- Chi tiáº¿t rÃµ rÃ ng hÆ¡n

#### 4.3. Gaussian Blur (LÃ m má» Gaussian)

**Táº¡i sao gá»i lÃ  "Gaussian"?**

Gaussian = TÃªn nhÃ  toÃ¡n há»c Carl Friedrich Gauss

Ã”ng táº¡o ra cÃ´ng thá»©c "Ä‘Æ°á»ng cong hÃ¬nh chuÃ´ng":

```
ÄÆ°á»ng cong Gaussian (bell curve):
      â—
    â— â— â—
  â— â— â— â— â—
â— â— â— â— â— â— â—
```

**LÃ m má» nhÆ° tháº¿ nÃ o?**

Má»—i pixel = Trung bÃ¬nh cÃ³ trá»ng sá»‘ cá»§a cÃ¡c pixel xung quanh

```
Kernel 3Ã—3 (ma tráº­n trá»ng sá»‘):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1   2   1  â”‚  â† Pixel xa Ã­t áº£nh hÆ°á»Ÿng (trá»ng sá»‘ nhá»)
â”‚ 2   4   2  â”‚  â† Pixel gáº§n áº£nh hÆ°á»Ÿng nhiá»u (trá»ng sá»‘ lá»›n)
â”‚ 1   2   1  â”‚  â† Pixel á»Ÿ giá»¯a áº£nh hÆ°á»Ÿng nháº¥t
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tá»•ng trá»ng sá»‘ = 16
```

**VÃ­ dá»¥ cá»¥ thá»ƒ:**

```
áº¢nh gá»‘c (vÃ¹ng 3Ã—3):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10  20  10â”‚
â”‚ 20 100  20â”‚  â† Pixel giá»¯a = 100
â”‚ 10  20  10â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TÃ­nh giÃ¡ trá»‹ má»›i cho pixel giá»¯a:
= (1Ã—10 + 2Ã—20 + 1Ã—10 + 2Ã—20 + 4Ã—100 + 2Ã—20 + 1Ã—10 + 2Ã—20 + 1Ã—10) / 16
= (10 + 40 + 10 + 40 + 400 + 40 + 10 + 40 + 10) / 16
= 600 / 16
= 37.5 â‰ˆ 38

Pixel giá»¯a: 100 â†’ 38 (má» hÆ¡n, gáº§n vá»›i hÃ ng xÃ³m hÆ¡n)
```

**Blur lá»›n vs Blur nhá»:**

```
Kernel 3Ã—3 (blur nháº¹):
TrÆ°á»›c: â–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–’â–’â–‘â–‘
Sau:   â–ˆâ–ˆâ–ˆâ–“â–“â–“â–’â–’â–‘â–‘  â† Chá»‰ má» nháº¹

Kernel 21Ã—21 (blur máº¡nh):
TrÆ°á»›c: â–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–’â–’â–‘â–‘
Sau:   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  â† Ráº¥t má», gáº§n nhÆ° Ä‘á»“ng Ä‘á»u
```

---

### ğŸ“– Pháº§n 2: Chi tiáº¿t tá»«ng bÆ°á»›c cá»§a Dodge-Burn

Äá»ƒ dá»… hiá»ƒu, tÃ´i sáº½ Ä‘i qua **1 pixel cá»¥ thá»ƒ** xem nÃ³ biáº¿n Ä‘á»•i tháº¿ nÃ o:

**Giáº£ sá»­:**
- áº¢nh ban Ä‘áº§u: Pixel cÃ³ giÃ¡ trá»‹ 80 (xÃ¡m trung bÃ¬nh)
- Vá»‹ trÃ­: Pixel (100, 200) - hÃ ng 100, cá»™t 200

**BÆ¯á»šC 1: Chuyá»ƒn sang Ä‘en tráº¯ng**
```
Náº¿u áº£nh gá»‘c lÃ  mÃ u:
RGB(120, 100, 80) â†’ Grayscale = (120+100+80)/3 â‰ˆ 100

Náº¿u Ä‘Ã£ lÃ  Ä‘en tráº¯ng: Giá»¯ nguyÃªn 80
```

**BÆ¯á»šC 2: CLAHE - Cáº£i thiá»‡n tÆ°Æ¡ng pháº£n**
```
Pixel = 80 (trung bÃ¬nh)

Sau CLAHE:
- VÃ¹ng nÃ y hÆ¡i tá»‘i â†’ TÄƒng lÃªn
- Pixel má»›i = 95

80 â†’ 95 (sÃ¡ng hÆ¡n 15 Ä‘Æ¡n vá»‹)
```

**BÆ¯á»šC 3: Äáº£o ngÆ°á»£c (Invert)**
```
CÃ´ng thá»©c: Pixel má»›i = 255 - Pixel cÅ©

95 â†’ 255 - 95 = 160

Giáº£i thÃ­ch:
- Pixel cÃ ng sÃ¡ng â†’ Sau Ä‘áº£o cÃ ng tá»‘i
- Pixel cÃ ng tá»‘i â†’ Sau Ä‘áº£o cÃ ng sÃ¡ng
```

**BÆ¯á»šC 4: Gaussian Blur**
```
Pixel = 160

NhÃ¬n cÃ¡c hÃ ng xÃ³m (giáº£ sá»­):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 150 155 150â”‚
â”‚ 155 160 155â”‚  â† Pixel cá»§a chÃºng ta
â”‚ 150 155 150â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Sau Blur (kernel 21Ã—21, trung bÃ¬nh vá»›i nhiá»u hÃ ng xÃ³m):
Pixel má»›i = 158 (gáº§n 160, nhÆ°ng mÆ°á»£t hÆ¡n)

160 â†’ 158
```

**BÆ¯á»šC 5: Äáº£o ngÆ°á»£c láº¡i**
```
158 â†’ 255 - 158 = 97

BÃ¢y giá» pixel = 97
```

**BÆ¯á»šC 6: Äáº£m báº£o khÃ´ng nhá» hÆ¡n 10**
```
Náº¿u pixel < 10 â†’ Set = 10

Pixel = 97 > 10 â†’ Giá»¯ nguyÃªn

Táº¡i sao? TrÃ¡nh chia cho sá»‘ quÃ¡ nhá» á»Ÿ bÆ°á»›c sau
```

**BÆ¯á»šC 7: Chia (BÆ°á»›c ma thuáº­t!)**
```
CÃ´ng thá»©c: Sketch = (Pixel CLAHE Ã— 256) / Pixel hiá»‡n táº¡i

Pixel CLAHE (bÆ°á»›c 2) = 95
Pixel hiá»‡n táº¡i (bÆ°á»›c 6) = 97

Sketch = (95 Ã— 256) / 97
       = 24,320 / 97
       = 250.72
       â‰ˆ 251

Káº¿t quáº£: 251 (ráº¥t sÃ¡ng!)
```

**Táº¡i sao láº¡i sÃ¡ng?**
- Pixel gá»‘c 95 vÃ  pixel xá»­ lÃ½ 97 Gáº¦N NHAU
- Khi chia 2 sá»‘ gáº§n nhau â†’ Káº¿t quáº£ gáº§n 1
- NhÃ¢n vá»›i 256 â†’ Káº¿t quáº£ lá»›n (sÃ¡ng)

**BÆ¯á»šC 8: Clip vá» [0, 255]**
```
251 náº±m trong [0, 255] â†’ Giá»¯ nguyÃªn

Náº¿u káº¿t quáº£ > 255 â†’ Set = 255
Náº¿u káº¿t quáº£ < 0 â†’ Set = 0
```

**BÆ¯á»šC 9: Blur nháº¹ cuá»‘i cÃ¹ng**
```
251 â†’ Sau blur (3Ã—3, ráº¥t nháº¹) â†’ 250

Giáº£m 1 Ä‘Æ¡n vá»‹ thÃ´i, gáº§n nhÆ° khÃ´ng Ä‘á»•i
```

**Káº¾T QUáº¢ CUá»I CÃ™NG:**
```
Pixel ban Ä‘áº§u: 80 (xÃ¡m trung bÃ¬nh)
Pixel sketch:  250 (gáº§n tráº¯ng)

â†’ VÃ¹ng nÃ y sáº½ lÃ  highlight (vÃ¹ng sÃ¡ng) trong tranh váº½
```

---

### ğŸ“– Pháº§n 3: Chi tiáº¿t tá»«ng bÆ°á»›c cá»§a Combined

Combined = Dodge-Burn + Edge Detection

ChÃºng ta Ä‘Ã£ hiá»ƒu Dodge-Burn rá»“i, giá» táº­p trung vÃ o Edge Detection!

#### Canny Edge Detection - 5 bÆ°á»›c chi tiáº¿t

**Chuáº©n bá»‹:**
- áº¢nh Ä‘áº§u vÃ o: Pixel (100, 200) = 120 (xÃ¡m sÃ¡ng)

**BÆ¯á»šC 1: CLAHE (giá»‘ng Dodge-Burn)**
```
120 â†’ 130 (tÄƒng tÆ°Æ¡ng pháº£n)
```

**BÆ¯á»šC 2: Bilateral Filter (LÃ m mÆ°á»£t giá»¯ viá»n)**
```
NhÃ¬n hÃ ng xÃ³m:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 130 130 130â”‚  â† VÃ¹ng Ä‘á»“ng Ä‘á»u
â”‚ 130 130 130â”‚  â† Pixel cá»§a chÃºng ta
â”‚ 130 130 130â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Sau filter: 130 (khÃ´ng Ä‘á»•i vÃ¬ hÃ ng xÃ³m giá»‘ng nhau)

NhÆ°ng giáº£ sá»­ hÃ ng xÃ³m khÃ¡c:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 130  50  50â”‚  â† CÃ³ viá»n á»Ÿ Ä‘Ã¢y!
â”‚ 130 130  50â”‚  â† Pixel cá»§a chÃºng ta
â”‚ 130  50  50â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Bilateral sáº½ CHá»ˆ láº¥y trung bÃ¬nh cÃ¡c pixel GIá»NG (130):
= (130 + 130 + 130) / 3 = 130

â†’ KhÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi pixel bÃªn kia viá»n (50)
â†’ VIá»€N GIá»® NGUYÃŠN!
```

**BÆ¯á»šC 3: TÃ­nh Gradient (Äá»™ dá»‘c)**

Giáº£ sá»­ 1 dÃ²ng pixel ngang:
```
[... 130, 130, 130, 50, 50, 50 ...]
            â†‘       â†‘
       Pixel ta  Pixel bÃªn

Gradient ngang (Gx):
= |Pixel pháº£i - Pixel trÃ¡i|
= |50 - 130| = 80

Gradient dá»c (Gy):
(TÆ°Æ¡ng tá»± cho hÆ°á»›ng dá»c)
Giáº£ sá»­ = 10

Gradient tá»•ng:
= âˆš(GxÂ² + GyÂ²)
= âˆš(80Â² + 10Â²)
= âˆš(6400 + 100)
= âˆš6500
â‰ˆ 80.6
```

**Ã nghÄ©a:**
- Gradient cao (80.6) â†’ CÃ³ thay Ä‘á»•i máº¡nh â†’ CÃ“ THá»‚ lÃ  viá»n
- Gradient tháº¥p (â‰¤10) â†’ KhÃ´ng Ä‘á»•i â†’ KHÃ”NG pháº£i viá»n

**BÆ¯á»šC 4: Non-Maximum Suppression (Giá»¯ Ä‘iá»ƒm cao nháº¥t)**

```
Trong vÃ¹ng 3Ã—3, cÃ³ nhiá»u pixel cÃ¹ng cao:

Gradient cá»§a vÃ¹ng:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 60  70  60â”‚
â”‚ 70  81  70â”‚  â† Pixel 81 cao nháº¥t
â”‚ 60  70  60â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â†’ CHá»ˆ giá»¯ pixel 81, loáº¡i bá» 70, 60
â†’ Viá»n chá»‰ dÃ y 1 pixel
```

**BÆ¯á»šC 5: Double Thresholding (NgÆ°á»¡ng kÃ©p)**

```
Giáº£ sá»­:
- Low threshold = 50
- High threshold = 100

Pixel cá»§a ta cÃ³ gradient = 81

PhÃ¢n loáº¡i:
- 81 > 100? KhÃ´ng â†’ KhÃ´ng pháº£i "cháº¯c cháº¯n lÃ  viá»n"
- 81 > 50?  CÃ³    â†’ LÃ  "nghi ngá» lÃ  viá»n"

â†’ Pixel nÃ y Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u "nghi ngá»" (weak edge)
```

**BÆ¯á»šC 6: Hysteresis (Theo dÃµi viá»n)**

```
NhÃ¬n hÃ ng xÃ³m cá»§a pixel "nghi ngá»":

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Cháº¯c cháº¯n] [KhÃ´ng] [KhÃ´ng]     â”‚
â”‚ [Nghi ngá»]  [pixel] [Nghi ngá»]  â”‚  â† Pixel cá»§a ta á»Ÿ giá»¯a
â”‚ [KhÃ´ng]     [KhÃ´ng] [KhÃ´ng]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Quy táº¯c:
- Náº¿u CÃ“ hÃ ng xÃ³m "cháº¯c cháº¯n" â†’ Giá»¯ láº¡i
- Náº¿u KHÃ”NG cÃ³ â†’ Loáº¡i bá»

Pixel cá»§a ta CÃ“ hÃ ng xÃ³m "cháº¯c cháº¯n"
â†’ GIá»® Láº I
â†’ GiÃ¡ trá»‹ = 255 (tráº¯ng - lÃ  viá»n)
```

**Káº¾T QUáº¢ Edge Detection:**
```
Pixel (100, 200) = 255 (viá»n)

CÃ¡c pixel khÃ´ng pháº£i viá»n = 0 (Ä‘en)
```

#### Káº¿t há»£p Dodge-Burn + Edges

**Tá»« cÃ¡c bÆ°á»›c trÆ°á»›c:**
- Dodge-Burn cho pixel nÃ y: 180 (khÃ¡ sÃ¡ng)
- Edges cho pixel nÃ y: 255 (lÃ  viá»n)

**Alpha Blending (Trá»™n):**
```
Combined = 0.7 Ã— Dodge-Burn + 0.3 Ã— Edges
         = 0.7 Ã— 180 + 0.3 Ã— 255
         = 126 + 76.5
         = 202.5
         â‰ˆ 203

â†’ Pixel káº¿t quáº£ = 203 (sÃ¡ng, nhÆ°ng khÃ´ng cá»±c sÃ¡ng)
```

**CÃ¡c bÆ°á»›c lÃ m Ä‘áº¹p:**

**1. Bilateral Filter**
```
203 â†’ 200 (mÆ°á»£t hÆ¡n chÃºt)
```

**2. Unsharp Masking**
```
Blur nháº¹: 200 â†’ 195
Unsharp: 200 + (200 - 195) = 200 + 5 = 205
â†’ 200 â†’ 205 (sáº¯c nÃ©t hÆ¡n)
```

**3. Morphological Gradient**
```
TÃ­nh gradient:
Dilation (phá»“ng): 205 â†’ 207
Erosion (co):     205 â†’ 203
Gradient = 207 - 203 = 4

Blend 10%:
= 0.9 Ã— 205 + 0.1 Ã— 4
= 184.5 + 0.4
= 184.9
â‰ˆ 185

â†’ 205 â†’ 185 (viá»n ná»•i hÆ¡n)
```

**Káº¾T QUáº¢ CUá»I:**
```
Pixel ban Ä‘áº§u: 120
Pixel sketch (Combined): 185

â†’ Pixel nÃ y sáº½ lÃ  vÃ¹ng sÃ¡ng trong tranh, vá»›i viá»n rÃµ rÃ ng
```

---

## 5. CÃCH Sá»¬ Dá»¤NG á»¨NG Dá»¤NG

### HÆ°á»›ng dáº«n tá»«ng bÆ°á»›c (nhÆ° dáº¡y ngÆ°á»i khÃ´ng biáº¿t gÃ¬ vá» mÃ¡y tÃ­nh)

#### BÆ°á»›c 1: CÃ i Ä‘áº·t (Chá»‰ lÃ m 1 láº§n)

**1.1. Kiá»ƒm tra Python Ä‘Ã£ cÃ i chÆ°a**

Má»Ÿ Terminal (Mac/Linux) hoáº·c Command Prompt (Windows):

```bash
python3 --version
```

Náº¿u hiá»‡n ra: `Python 3.8.x` hoáº·c cao hÆ¡n â†’ OK!
Náº¿u bÃ¡o lá»—i â†’ Cáº§n cÃ i Python tá»« python.org

**1.2. Di chuyá»ƒn vÃ o thÆ° má»¥c dá»± Ã¡n**

```bash
cd /Volumes/QUANGANH1TB/Coding/SketchLab
```

**1.3. Táº¡o mÃ´i trÆ°á»ng áº£o (Virtual Environment)**

TÆ°á»Ÿng tÆ°á»£ng: Táº¡o 1 "phÃ²ng riÃªng" cho dá»± Ã¡n nÃ y, khÃ´ng áº£nh hÆ°á»Ÿng mÃ¡y tÃ­nh

```bash
python3 -m venv venv
```

Sau lá»‡nh nÃ y, xuáº¥t hiá»‡n thÆ° má»¥c `venv/`

**1.4. KÃ­ch hoáº¡t mÃ´i trÆ°á»ng**

Mac/Linux:
```bash
source venv/bin/activate
```

Windows:
```bash
venv\Scripts\activate
```

Tháº¥y `(venv)` á»Ÿ Ä‘áº§u dÃ²ng lá»‡nh â†’ ThÃ nh cÃ´ng!

**1.5. CÃ i Ä‘áº·t thÆ° viá»‡n cáº§n thiáº¿t**

```bash
pip install -r requirements.txt
```

Chá» vÃ i phÃºt... CÃ i Ä‘áº·t xong!

#### BÆ°á»›c 2: Cháº¡y á»©ng dá»¥ng

```bash
python app.py
```

Tháº¥y dÃ²ng:
```
Starting SketchLab server...
Access at: http://127.0.0.1:5000
```

â†’ ThÃ nh cÃ´ng!

#### BÆ°á»›c 3: Má»Ÿ trÃ¬nh duyá»‡t

Má»Ÿ Chrome, Firefox, Safari... gÃµ:
```
http://127.0.0.1:5000
```

Hoáº·c:
```
http://localhost:5000
```

â†’ Tháº¥y giao diá»‡n upload áº£nh!

#### BÆ°á»›c 4: Upload áº£nh

**CÃ¡ch 1: KÃ©o tháº£**
```
ğŸ“ TÃ¬m áº£nh trong mÃ¡y tÃ­nh
â†’ KÃ©o vÃ o vÃ¹ng "Drop Zone"
â†’ Tháº£ chuá»™t
```

**CÃ¡ch 2: Click chá»n**
```
Click "Chá»n File"
â†’ Chá»n áº£nh
â†’ Click "Open"
```

**áº¢nh há»— trá»£:**
- PNG (.png)
- JPEG (.jpg, .jpeg)
- KÃ­ch thÆ°á»›c: Tá»‘i Ä‘a 16MB

#### BÆ°á»›c 5: Chá»n thuáº­t toÃ¡n

CÃ³ 2 lá»±a chá»n:

**Combined Sketch (KhuyÃªn dÃ¹ng)**
- Vá»«a cÃ³ nÃ©t, vá»«a cÃ³ bÃ³ng
- Äáº¹p vá»›i má»i loáº¡i áº£nh
- Cháº­m hÆ¡n 1 chÃºt

**Dodge-Burn Sketch**
- Chá»§ yáº¿u tÃ´ bÃ³ng
- Nghá»‡ thuáº­t hÆ¡n
- Nhanh hÆ¡n

â†’ Click chá»n 1 trong 2

#### BÆ°á»›c 6: Xá»­ lÃ½

Click nÃºt **"Xá»­ lÃ½ áº£nh"**

Äá»£i 1-3 giÃ¢y...

â†’ Tá»± Ä‘á»™ng chuyá»ƒn sang trang káº¿t quáº£!

#### BÆ°á»›c 7: Xem káº¿t quáº£

Tháº¥y 2 áº£nh cáº¡nh nhau:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  áº¢nh gá»‘c    â”‚  áº¢nh sketch â”‚
â”‚     ğŸ“¸      â”‚      âœï¸      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

So sÃ¡nh dá»… dÃ ng!

#### BÆ°á»›c 8: Táº£i vá»

Click nÃºt **"Táº£i vá»"**

áº¢nh sketch sáº½ Ä‘Æ°á»£c táº£i vá» mÃ¡y!

---

## 6. CÃ‚U Há»I THÆ¯á»œNG Gáº¶P

### â“ CÃ¢u há»i 1: Táº¡i sao pháº£i "Ä‘áº£o ngÆ°á»£c" áº£nh?

**Tráº£ lá»i Ä‘Æ¡n giáº£n:**

CÃ´ng thá»©c Dodge-Burn cáº§n chia 2 sá»‘. Äá»ƒ táº¡o hiá»‡u á»©ng Ä‘Ãºng, ta cáº§n:
- áº¢nh gá»‘c: SÃ¡ng á»Ÿ chá»— cáº§n sÃ¡ng
- áº¢nh máº«u sá»‘: Tá»‘i á»Ÿ chá»— cáº§n sÃ¡ng

â†’ Pháº£i Ä‘áº£o ngÆ°á»£c Ä‘á»ƒ "sÃ¡ng" thÃ nh "tá»‘i"

**Giáº£i thÃ­ch ká»¹:**

Nhá»› cÃ´ng thá»©c: `Sketch = áº¢nh gá»‘c / áº¢nh xá»­ lÃ½`

```
TrÆ°á»ng há»£p 1: VÃ¹ng sÃ¡ng trong áº£nh gá»‘c
- áº¢nh gá»‘c = 200 (sÃ¡ng)
- áº¢nh xá»­ lÃ½ = 50 (tá»‘i - vÃ¬ Ä‘Ã£ Ä‘áº£o tá»« vÃ¹ng sÃ¡ng)
- Sketch = 200 / 50 = 4 (ráº¥t lá»›n, nhÃ¢n 256 â†’ ráº¥t sÃ¡ng âœ¨)

TrÆ°á»ng há»£p 2: VÃ¹ng tá»‘i trong áº£nh gá»‘c
- áº¢nh gá»‘c = 50 (tá»‘i)
- áº¢nh xá»­ lÃ½ = 200 (sÃ¡ng - vÃ¬ Ä‘Ã£ Ä‘áº£o tá»« vÃ¹ng tá»‘i)
- Sketch = 50 / 200 = 0.25 (ráº¥t nhá», nhÃ¢n 256 â†’ tá»‘i ğŸ–¤)
```

â†’ Káº¿t quáº£: VÃ¹ng sÃ¡ng váº«n sÃ¡ng, vÃ¹ng tá»‘i váº«n tá»‘i, nhÆ°ng cÃ³ hiá»‡u á»©ng sketch!

### â“ CÃ¢u há»i 2: Táº¡i sao pháº£i lÃ m má»?

**Tráº£ lá»i Ä‘Æ¡n giáº£n:**

Váº½ bÃºt chÃ¬ tháº­t khÃ´ng cÃ³ Ä‘Æ°á»ng nÃ©t cá»©ng nháº¯c, mÃ  má»m máº¡i, cÃ³ gradient (chuyá»ƒn dáº§n tá»« tá»‘i sang sÃ¡ng).

Blur = Táº¡o gradient tá»± nhiÃªn

**VÃ­ dá»¥:**

```
KhÃ´ng blur:
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† Cá»©ng nháº¯c, nhÆ° in mÃ¡y tÃ­nh
        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

CÃ³ blur:
â–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–’â–’â–‘â–‘â–‘â–‘  â† Má»m máº¡i, nhÆ° váº½ tay
```

### â“ CÃ¢u há»i 3: Táº¡i sao Combined tá»‘t hÆ¡n Dodge-Burn?

**Tráº£ lá»i:**

KhÃ´ng pháº£i "tá»‘t hÆ¡n", mÃ  "phÃ¹ há»£p hÆ¡n vá»›i nhiá»u áº£nh"!

**So sÃ¡nh:**

| Loáº¡i áº£nh | Dodge-Burn | Combined |
|----------|------------|----------|
| ChÃ¢n dung | â­â­â­â­â­ (Ráº¥t tá»‘t) | â­â­â­â­ (Tá»‘t) |
| Phong cáº£nh | â­â­â­ (Trung bÃ¬nh) | â­â­â­â­â­ (Ráº¥t tá»‘t) |
| Kiáº¿n trÃºc | â­â­ (KÃ©m) | â­â­â­â­â­ (Ráº¥t tá»‘t) |
| Nghá»‡ thuáº­t | â­â­â­â­â­ (Ráº¥t tá»‘t) | â­â­â­ (Trung bÃ¬nh) |

**LÃ½ do:**
- **Dodge-Burn**: Má»m, nghá»‡ thuáº­t â†’ Tá»‘t cho chÃ¢n dung, cáº§n cáº£m xÃºc
- **Combined**: RÃµ rÃ ng, chi tiáº¿t â†’ Tá»‘t cho kiáº¿n trÃºc, cáº§n Ä‘á»™ chÃ­nh xÃ¡c

### â“ CÃ¢u há»i 4: CLAHE lÃ m gÃ¬ mÃ  quan trá»ng váº­y?

**Tráº£ lá»i:**

CLAHE cá»©u cÃ¡c áº£nh "khÃ³":

**VÃ­ dá»¥ 1: áº¢nh ngÆ°á»£c sÃ¡ng**
```
áº¢nh gá»‘c:
- Máº·t ngÆ°á»i: Ráº¥t tá»‘i (vÃ¬ máº·t trá»i phÃ­a sau)
- Ná»n trá»i: Ráº¥t sÃ¡ng

KhÃ´ng cÃ³ CLAHE:
- Xá»­ lÃ½ â†’ Máº·t máº¥t háº¿t chi tiáº¿t (Ä‘en ká»‹t)

CÃ³ CLAHE:
- LÃ m sÃ¡ng vÃ¹ng máº·t
- LÃ m tá»‘i vÃ¹ng trá»i
- Máº·t cÃ³ chi tiáº¿t rÃµ!
```

**VÃ­ dá»¥ 2: áº¢nh ban Ä‘Ãªm**
```
áº¢nh gá»‘c: ToÃ n bá»™ tá»‘i

KhÃ´ng CLAHE:
- Sketch â†’ Äen ká»‹t, khÃ´ng tháº¥y gÃ¬

CÃ³ CLAHE:
- TÄƒng sÃ¡ng vÃ¹ng tá»‘i
- Sketch â†’ Tháº¥y chi tiáº¿t!
```

### â“ CÃ¢u há»i 5: Táº¡i sao pháº£i "clip" vá» 10 á»Ÿ bÆ°á»›c 4?

**Tráº£ lá»i:**

TrÃ¡nh chia cho sá»‘ quÃ¡ nhá»!

**Váº¥n Ä‘á»:**

```
Náº¿u máº«u sá»‘ = 1:
Sketch = 100 Ã— 256 / 1 = 25,600

NhÆ°ng pixel chá»‰ cÃ³ giÃ¡ trá»‹ max = 255!
â†’ 25,600 sáº½ bá»‹ "cáº¯t" thÃ nh 255
â†’ Táº¡o "Ä‘á»‘m tráº¯ng" (white spots) ráº¥t xáº¥u
```

**Giáº£i phÃ¡p:**

```
Set minimum = 10:
Sketch max = 100 Ã— 256 / 10 = 2,560

Váº«n lá»›n, nhÆ°ng:
- KhÃ´ng quÃ¡ cá»±c Ä‘oan
- Sau clip vá» 255, váº«n giá»¯ gradient
- KhÃ´ng táº¡o Ä‘á»‘m tráº¯ng Ä‘á»™t ngá»™t
```

### â“ CÃ¢u há»i 6: Unsharp Masking hoáº¡t Ä‘á»™ng tháº¿ nÃ o?

**Tráº£ lá»i báº±ng vÃ­ dá»¥ thá»±c táº¿:**

TÆ°á»Ÿng tÆ°á»£ng báº¡n cÃ³ 2 bá»©c áº£nh:
1. áº¢nh gá»‘c (rÃµ)
2. áº¢nh má»

**BÆ°á»›c 1:** So sÃ¡nh 2 áº£nh
```
áº¢nh gá»‘c:  â–“â–“â–“â–“â–“â–“  â† CÃ³ chi tiáº¿t nhá»
áº¢nh má»:   â–‘â–‘â–‘â–‘â–‘â–‘  â† Máº¥t chi tiáº¿t

KhÃ¡c biá»‡t = áº¢nh gá»‘c - áº¢nh má» = Chi tiáº¿t nhá»
```

**BÆ°á»›c 2:** ThÃªm chi tiáº¿t vÃ o áº£nh gá»‘c
```
áº¢nh gá»‘c + Chi tiáº¿t = áº¢nh ráº¥t rÃµ!

NhÆ° tháº¿ nÃ y:
- Báº¡n Ä‘ang nghe nháº¡c Ã¢m lÆ°á»£ng 50
- TÄƒng thÃªm 20
- â†’ Nghe rÃµ hÆ¡n (Ã¢m lÆ°á»£ng 70)
```

**Táº¡i sao gá»i "Unsharp"?**

VÃ¬ dÃ¹ng áº£nh "khÃ´ng sáº¯c nÃ©t" (má») Ä‘á»ƒ táº¡o áº£nh "sáº¯c nÃ©t"! ğŸ˜„

### â“ CÃ¢u há»i 7: Morphological operations lÃ  gÃ¬?

**Tráº£ lá»i Ä‘Æ¡n giáº£n:**

Morphology = HÃ¬nh thÃ¡i há»c (nghiÃªn cá»©u hÃ¬nh dáº¡ng)

**2 phÃ©p toÃ¡n cÆ¡ báº£n:**

**Erosion (Co láº¡i):**
```
TrÆ°á»›c:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

Sau:      Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·  â† Nhá» hÆ¡n, biÃªn bá»‹ "Äƒn mÃ²n"
          Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·
          Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·
```

**Dilation (Phá»“ng ra):**
```
TrÆ°á»›c:    Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·
          Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·
          Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·

Sau:      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† Lá»›n hÆ¡n, biÃªn "phá»“ng" ra
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

**Opening (Co + Phá»“ng):**
```
DÃ¹ng Ä‘á»ƒ: XÃ³a nhiá»…u nhá»

áº¢nh cÃ³ nhiá»…u:  â–ˆâ–ˆâ–ˆÂ·â–ˆÂ·â–ˆâ–ˆâ–ˆ  â† CÃ³ Ä‘iá»ƒm nhá»
Sau Opening:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† Äiá»ƒm nhá» máº¥t
```

**Morphological Gradient (Phá»“ng - Co):**
```
Dilation:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Erosion:   Â·â–ˆâ–ˆâ–ˆâ–ˆâ–ˆÂ·
Gradient:  â–ˆÂ·Â·Â·Â·Â·â–ˆ  â† CHá»ˆ cÃ²n viá»n!
           â–ˆÂ·Â·Â·Â·Â·â–ˆ
           â–ˆÂ·Â·Â·Â·Â·â–ˆ
```

---

## 7. Tá»”NG Káº¾T

### ğŸ¯ Nhá»¯ng Ä‘iá»u quan trá»ng nháº¥t

#### 1. Hai phÆ°Æ¡ng phÃ¡p chÃ­nh

**Dodge-Burn:**
- Táº¡o hiá»‡u á»©ng tÃ´ bÃ³ng tá»± nhiÃªn
- Giá»‘ng váº½ báº±ng bÃºt chÃ¬ tháº­t
- Tá»‘t cho: ChÃ¢n dung, nghá»‡ thuáº­t

**Combined:**
- Káº¿t há»£p tÃ´ bÃ³ng (70%) + viá»n (30%)
- RÃµ rÃ ng hÆ¡n, chi tiáº¿t hÆ¡n
- Tá»‘t cho: Má»i loáº¡i áº£nh

#### 2. CÃ¡c bÆ°á»›c then chá»‘t

**CLAHE:**
- Cáº£i thiá»‡n Ä‘á»™ tÆ°Æ¡ng pháº£n
- LÃ m sÃ¡ng vÃ¹ng tá»‘i, tá»‘i vÃ¹ng sÃ¡ng
- GiÃºp áº£nh "khÃ³" trá»Ÿ nÃªn dá»… xá»­ lÃ½

**Gaussian Blur:**
- Táº¡o hiá»‡u á»©ng má»m máº¡i
- LÃ m gradient tá»± nhiÃªn
- Quan trá»ng cho Dodge-Burn

**Canny Edge Detection:**
- TÃ¬m viá»n chÃ­nh xÃ¡c nháº¥t
- 5 bÆ°á»›c thÃ´ng minh
- Quan trá»ng cho Combined

**Alpha Blending:**
- Trá»™n 2 áº£nh theo tá»· lá»‡
- 70-30 lÃ  tá»· lá»‡ vÃ ng
- CÃ¢n báº±ng giá»¯a má»m vÃ  rÃµ

#### 3. Táº¡i sao dá»± Ã¡n nÃ y hay?

**Vá» máº·t há»c thuáº­t:**
- Ãp dá»¥ng nhiá»u thuáº­t toÃ¡n: CLAHE, Canny, Bilateral, Morphology
- Káº¿t há»£p sÃ¡ng táº¡o: Dodge-Burn + Edge Detection
- Hiá»ƒu sÃ¢u lÃ½ thuyáº¿t

**Vá» máº·t thá»±c tiá»…n:**
- Táº¡o app tháº­t sá»± dÃ¹ng Ä‘Æ°á»£c
- Giao diá»‡n Ä‘áº¹p, dá»… dÃ¹ng
- Káº¿t quáº£ cháº¥t lÆ°á»£ng cao

**Vá» máº·t ká»¹ nÄƒng:**
- Láº­p trÃ¬nh Python/OpenCV
- Web development (Flask)
- Software engineering (modular code)

### ğŸ“Š So sÃ¡nh tá»•ng quan

| TiÃªu chÃ­ | Dodge-Burn | Combined |
|----------|------------|----------|
| **Äá»™ khÃ³** | ğŸŒŸğŸŒŸ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ |
| **Tá»‘c Ä‘á»™** | âš¡âš¡âš¡ | âš¡âš¡ |
| **Cháº¥t lÆ°á»£ng chung** | ğŸ¨ğŸ¨ğŸ¨ğŸ¨ | ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ |
| **Shading** | â­â­â­â­â­ | â­â­â­â­ |
| **Edges** | â­â­ | â­â­â­â­â­ |
| **KhuyÃªn dÃ¹ng** | ChÃ¢n dung | Tá»•ng quÃ¡t |

### ğŸš€ á»¨ng dá»¥ng thá»±c táº¿

Dá»± Ã¡n nÃ y cÃ³ thá»ƒ dÃ¹ng cho:

1. **Nghá»‡ thuáº­t:**
   - Chuyá»ƒn áº£nh thÃ nh sketch Ä‘á»ƒ in lÃªn Ã¡o, cá»‘c
   - Táº¡o áº£nh Ä‘áº¡i diá»‡n nghá»‡ thuáº­t
   - Thiáº¿t káº¿ poster

2. **GiÃ¡o dá»¥c:**
   - Há»c váº½: So sÃ¡nh áº£nh sketch vá»›i báº£n váº½ tay
   - Dáº¡y hÃ¬nh há»c: NhÃ¬n rÃµ Ä‘Æ°á»ng nÃ©t

3. **Thiáº¿t káº¿:**
   - Táº¡o mockup sáº£n pháº©m
   - Wireframe cho UI/UX
   - Storyboard phim

### ğŸ’¡ BÃ i há»c rÃºt ra

**1. ÄÆ¡n giáº£n hÃ³a váº¥n Ä‘á» phá»©c táº¡p:**
- Chia nhá» thÃ nh cÃ¡c bÆ°á»›c
- Giáº£i quyáº¿t tá»«ng bÆ°á»›c má»™t
- Káº¿t há»£p láº¡i

**2. Káº¿t há»£p nhiá»u ká»¹ thuáº­t:**
- KhÃ´ng cÃ³ 1 thuáº­t toÃ¡n hoÃ n háº£o
- Káº¿t há»£p nhiá»u thuáº­t toÃ¡n â†’ Káº¿t quáº£ tá»‘t hÆ¡n
- Combined = Dodge-Burn + Canny

**3. Tuning parameters quan trá»ng:**
- blur_ksize = 21 (khÃ´ng pháº£i 10, khÃ´ng pháº£i 50)
- alpha = 0.7, beta = 0.3 (khÃ´ng pháº£i 0.5-0.5)
- â†’ Thá»­ nghiá»‡m nhiá»u láº§n má»›i ra con sá»‘ tá»‘t

### ğŸ“ Kiáº¿n thá»©c Ä‘Ã£ há»c

**Xá»­ lÃ½ áº£nh:**
- Histogram Equalization
- Edge Detection (Canny)
- Morphological Operations
- Image Filtering (Gaussian, Bilateral)
- Image Blending

**Láº­p trÃ¬nh:**
- Python programming
- OpenCV library
- NumPy arrays
- Error handling

**Web development:**
- Flask framework
- RESTful API
- Frontend-backend integration
- File handling

### ğŸŒŸ Äiá»ƒm ná»•i báº­t cá»§a dá»± Ã¡n

**1. Cháº¥t lÆ°á»£ng cao:**
- Sá»­ dá»¥ng thuáº­t toÃ¡n state-of-the-art
- CLAHE cho adaptive enhancement
- Canny cho edge detection tá»‘t nháº¥t

**2. SÃ¡ng táº¡o:**
- Káº¿t há»£p Dodge-Burn (nhiáº¿p áº£nh) + Canny (CV)
- Tá»· lá»‡ 70-30 qua thá»­ nghiá»‡m
- Post-processing nhiá»u táº§ng

**3. HoÃ n thiá»‡n:**
- Full-stack application
- User-friendly interface
- Comprehensive error handling
- Auto cleanup, auto resize

### ğŸ“ˆ HÆ°á»›ng phÃ¡t triá»ƒn

**Ngáº¯n háº¡n:**
- ThÃªm slider cho user tá»± chá»n alpha/beta
- Real-time preview
- Batch processing

**DÃ i háº¡n:**
- Deep learning (pix2pix, CycleGAN)
- Mobile app
- Cloud deployment
- API for integration

---

## PHá»¤ Lá»¤C: GIáº¢I THÃCH THÃŠM

### A. Táº¡i sao dÃ¹ng 256 trong cÃ´ng thá»©c chia?

**CÃ¢u há»i:** `Sketch = (Gray Ã— 256) / InvertedBlur`

Táº¡i sao nhÃ¢n 256, khÃ´ng pháº£i 100 hay 255?

**Tráº£ lá»i:**

```
Giáº£ sá»­ khÃ´ng nhÃ¢n (scale = 1):
- Gray = 100
- InvertedBlur = 100
- Sketch = 100 / 100 = 1

â†’ Káº¿t quáº£ quÃ¡ Tá»I (1 gáº§n nhÆ° Ä‘en)

NhÃ¢n 255:
Sketch = 100 Ã— 255 / 100 = 255

â†’ LuÃ´n ra 255 (quÃ¡ SÃNG)

NhÃ¢n 256:
Sketch = 100 Ã— 256 / 100 = 256 â†’ clip vá» 255

â†’ Vá»«a Ä‘á»§ sÃ¡ng, giá»‘ng giáº¥y váº½ tráº¯ng!
```

**256 = 2^8:**
- Dá»… tÃ­nh toÃ¡n cho mÃ¡y tÃ­nh (lÅ©y thá»«a 2)
- Empirically tá»‘t nháº¥t

### B. Táº¡i sao Bilateral Filter giá»¯ Ä‘Æ°á»£c viá»n?

**Giáº£i thÃ­ch chi tiáº¿t:**

Gaussian Filter thÆ°á»ng:
```
Pixel vÃ  hÃ ng xÃ³m:
[100, 100, 100, 200, 200, 200]
               â†‘
         Pixel á»Ÿ viá»n

Gaussian blur:
= (100 + 100 + 100 + 200 + 200 + 200) / 6
= 150

â†’ Viá»n bá»‹ Má»œ (tá»« 100-200 thÃ nh 150)
```

Bilateral Filter:
```
CÃ´ng thá»©c: Chá»‰ láº¥y trung bÃ¬nh pixel GIá»NG

Pixel = 100
HÃ ng xÃ³m bÃªn trÃ¡i: 100, 100 (GIá»NG)
HÃ ng xÃ³m bÃªn pháº£i: 200, 200 (KHÃC)

Bilateral chá»‰ láº¥y pixel GIá»NG:
= (100 + 100 + 100) / 3 = 100

â†’ Viá»n GIá»® NGUYÃŠN (váº«n 100)
```

**CÃ´ng thá»©c tháº­t (Ä‘Æ¡n giáº£n hÃ³a):**

```
Trá»ng sá»‘ = Gaussian(khoáº£ng cÃ¡ch) Ã— Gaussian(Ä‘á»™ khÃ¡c mÃ u)

Pixel giá»‘ng:
- Äá»™ khÃ¡c mÃ u = 0 â†’ Gaussian(0) = 1 â†’ Trá»ng sá»‘ CAO

Pixel khÃ¡c:
- Äá»™ khÃ¡c mÃ u = 100 â†’ Gaussian(100) â‰ˆ 0 â†’ Trá»ng sá»‘ THáº¤P

â†’ Chá»‰ pixel giá»‘ng Ä‘Æ°á»£c tÃ­nh!
```

### C. Adaptive Thresholding cá»§a Canny

**Táº¡i sao dÃ¹ng median?**

```
áº¢nh sÃ¡ng:
Median = 150 â†’ Low = 100, High = 200

áº¢nh tá»‘i:
Median = 50 â†’ Low = 33, High = 67

â†’ Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh theo Ä‘á»™ sÃ¡ng áº£nh!
```

**Táº¡i sao sigma = 0.33?**

Tá»« research paper cá»§a Canny:
- 0.33 cho káº¿t quáº£ Tá»T NHáº¤T trÃªn nhiá»u loáº¡i áº£nh
- KhÃ´ng quÃ¡ cháº·t, khÃ´ng quÃ¡ lá»ng

```
Náº¿u sigma = 0.1 (cháº·t):
Low = 90% median, High = 110% median
â†’ QuÃ¡ cháº·t, máº¥t viá»n nhá»

Náº¿u sigma = 0.5 (lá»ng):
Low = 50% median, High = 150% median
â†’ QuÃ¡ lá»ng, nhiá»…u Ä‘Æ°á»£c coi lÃ  viá»n

sigma = 0.33 (vá»«a):
Low = 67% median, High = 133% median
â†’ CÃ¢n báº±ng!
```

### D. VÃ­ dá»¥ hoÃ n chá»‰nh tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i

**Input:** áº¢nh chÃ¢n dung 1024Ã—768 pixels

**BÆ°á»›c 1: Upload**
- User chá»n file "portrait.jpg" (2.5 MB)
- Browser gá»­i lÃªn server
- Server lÆ°u: `portrait_20251123_143055.jpg`

**BÆ°á»›c 2: Load & Resize**
```
áº¢nh gá»‘c: 4000Ã—3000 pixels (lá»›n)
Resize: 1024Ã—768 pixels (giá»¯ tá»· lá»‡)
â†’ Tá»‘c Ä‘á»™: 10s â†’ 2s
```

**BÆ°á»›c 3: Chá»n Combined**

**BÆ°á»›c 4: Xá»­ lÃ½**

Vá»›i 1 pixel á»Ÿ mÃ¡ (vÃ¹ng sÃ¡ng, ná»n):

```
[áº¢nh gá»‘c RGB]
(200, 180, 160) â†’ Grayscale = 180

[CLAHE]
180 â†’ 190 (tÄƒng contrast)

[Branch A: Dodge-Burn]
190 â†’ Invert â†’ 65
65 â†’ Blur â†’ 70
70 â†’ Invert â†’ 185
190 / 185 Ã— 256 = 263 â†’ clip 255
â†’ Dodge-Burn = 255

[Branch B: Canny Edges]
190 â†’ CLAHE â†’ 195
195 â†’ Bilateral â†’ 195
195 â†’ Gradient = 10 (vÃ¹ng pháº³ng)
10 < 50 (threshold) â†’ KHÃ”NG pháº£i viá»n
â†’ Edges = 0

[Combine]
0.7 Ã— 255 + 0.3 Ã— 0 = 178.5 â†’ 179

[Bilateral]
179 â†’ 180

[Unsharp]
180 â†’ Blur 178 â†’ 180 + (180-178) = 182

[Morph Gradient]
182 â†’ Dilation 183, Erosion 181
Gradient = 2
0.9Ã—182 + 0.1Ã—2 = 164

[Denoise]
Opening: 164 â†’ 164 (khÃ´ng Ä‘á»•i)

â†’ Káº¿t quáº£ cuá»‘i: 164
```

**BÆ°á»›c 5: LÆ°u**
- LÆ°u: `sketch_portrait_20251123_143055.jpg`
- Thá»i gian xá»­ lÃ½: 1.8s

**BÆ°á»›c 6: Hiá»ƒn thá»‹**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  portrait.jpg   â”‚  sketch_...jpg  â”‚
â”‚   (áº£nh mÃ u)     â”‚  (Ä‘en tráº¯ng)    â”‚
â”‚     ğŸ“¸          â”‚       âœï¸         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**BÆ°á»›c 7: Download**
- User click "Táº£i vá»"
- Browser táº£i file vá» mÃ¡y
- KÃ­ch thÆ°á»›c: ~500 KB (tá»« 2.5 MB)

---

## Káº¾T LUáº¬N

### Nhá»¯ng gÃ¬ báº¡n Ä‘Ã£ há»c Ä‘Æ°á»£c

Sau khi Ä‘á»c bÃ¡o cÃ¡o nÃ y, báº¡n Ä‘Ã£ hiá»ƒu:

âœ… **KhÃ¡i niá»‡m cÆ¡ báº£n:**
- áº¢nh lÃ  ma tráº­n sá»‘
- Pixel, grayscale, RGB
- Histogram

âœ… **Hai phÆ°Æ¡ng phÃ¡p chÃ­nh:**
- Dodge-Burn: TÃ´ bÃ³ng tá»± nhiÃªn
- Combined: Káº¿t há»£p tÃ´ bÃ³ng + viá»n

âœ… **CÃ¡c thuáº­t toÃ¡n:**
- CLAHE: Cáº£i thiá»‡n tÆ°Æ¡ng pháº£n
- Gaussian Blur: LÃ m má»
- Canny: PhÃ¡t hiá»‡n biÃªn
- Bilateral: Lá»c giá»¯ viá»n
- Morphological: Xá»­ lÃ½ hÃ¬nh thÃ¡i

âœ… **Táº¡i sao má»—i bÆ°á»›c quan trá»ng:**
- KhÃ´ng pháº£i lÃ m vÃ¬ lÃ m
- Má»—i bÆ°á»›c cÃ³ lÃ½ do rÃµ rÃ ng
- Káº¿t há»£p táº¡o káº¿t quáº£ tá»‘t

âœ… **CÃ¡ch sá»­ dá»¥ng app:**
- Upload â†’ Chá»n â†’ Xá»­ lÃ½ â†’ Táº£i vá»
- ÄÆ¡n giáº£n, ai cÅ©ng dÃ¹ng Ä‘Æ°á»£c

### Lá»i káº¿t

Dá»± Ã¡n **SketchLab** lÃ  minh chá»©ng cho viá»‡c:

**Khoa há»c + Nghá»‡ thuáº­t = Káº¿t quáº£ tuyá»‡t vá»i**

Tá»« nhá»¯ng cÃ´ng thá»©c toÃ¡n há»c khÃ´ khan:
```python
Sketch = (Gray Ã— 256) / (255 - Blur(Invert))
```

Äáº¿n nhá»¯ng bá»©c tranh nghá»‡ thuáº­t Ä‘áº¹p máº¯t:
```
ğŸ“¸ â†’ âœï¸
```

**ÄÃ³ lÃ  sá»©c máº¡nh cá»§a Xá»­ lÃ½ áº£nh!**

---

**Háº¾T BÃO CÃO**

---

*BÃ¡o cÃ¡o nÃ y Ä‘Æ°á»£c viáº¿t vá»›i má»¥c Ä‘Ã­ch giáº£i thÃ­ch Ä‘Æ¡n giáº£n, dá»… hiá»ƒu cho ngÆ°á»i má»›i báº¯t Ä‘áº§u.*
*Má»i khÃ¡i niá»‡m Ä‘á»u Ä‘Æ°á»£c giáº£i thÃ­ch báº±ng ngÃ´n ngá»¯ Ä‘á»i thÆ°á»ng, vÃ­ dá»¥ cá»¥ thá»ƒ, vÃ  hÃ¬nh áº£nh minh há»a.*
*Náº¿u váº«n cÃ²n chá»— nÃ o chÆ°a rÃµ, Ä‘á»«ng ngáº§n ngáº¡i há»i thÃªm!*

**ChÃºc báº¡n thÃ nh cÃ´ng vá»›i dá»± Ã¡n! ğŸ‰**
